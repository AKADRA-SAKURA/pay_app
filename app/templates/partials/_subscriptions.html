<!-- サブスク追加 -->
<div class="card">
  <h2>サブスク追加 <span class="pill">毎月の固定費</span></h2>

  <form method="post" action="/subscriptions" class="form">
    <label class="col-span-all">
      名称
      <input name="name" placeholder="Netflix" required />
    </label>

    <label>
      金額（円）
      <input name="amount_yen" type="number" min="0" value="0" required />
    </label>

    <label>
      毎月の請求日（1-31）
      <input name="billing_day" type="number" min="1" max="31" value="1" required />
    </label>

    <label>
    支払い方法
    <select name="payment_method" required>
        <option value="bank">口座引落</option>
        <option value="card">カード</option>
    </select>
    </label>

    <label>
    引落口座（bankのとき）
    <select name="account_id">
        <option value="">-</option>
        {% for a in accounts %}
        <option value="{{ a.id }}">{{ a.name }}（ID:{{ a.id }}）</option>
        {% endfor %}
    </select>
    </label>

    <label>
    カード（cardのとき）
    <select name="card_id">
        <option value="">-</option>
        {% for c in cards %}
        <option value="{{ c.id }}">{{ c.name }}（ID:{{ c.id }}）</option>
        {% endfor %}
    </select>
    </label>

    <div class="actions col-span-all">
      <button class="btn" type="submit">追加する</button>
      <button class="btn btn-ghost" type="reset">クリア</button>
    </div>

    <div class="hint" style="grid-column: 1 / -1">
      ※ まずは簡易版（1〜31固定）。月末（30/31/28）補正や「支払日カレンダー」は次で入れよう。
    </div>
  </form>
    <!-- サブスク一覧 -->
    <div class="mt-14">
    <h2>一覧 <span class="pill">登録済み</span></h2>

    <table>
        <thead>
        <tr>
            <th style="width: 70px">ID</th>
            <th>名称</th>
            <th style="width: 140px">金額</th>
            <th style="width: 150px">請求日</th>
            <th style="width: 100px"></th>
        </tr>
        </thead>

        <tbody>
        {% for s in subs %}
        <tr data-edit-row>
            <td>{{ s.id }}</td>
            <td>
              <input class="edit-input" name="name" value="{{ s.name }}" form="sub-{{ s.id }}" required />
            </td>
            <td class="money">
              <input class="edit-input" name="amount_yen" type="number" min="0" value="{{ s.amount_yen }}" form="sub-{{ s.id }}" required />
            </td>
            <td>
              <input class="edit-input" name="billing_day" type="number" min="1" max="31" value="{{ s.billing_day }}" form="sub-{{ s.id }}" required />
            </td>
            <td class="edit-actions">
              <button class="btn btn-ghost edit-btn" type="button" data-edit="start">Edit</button>
              <form id="sub-{{ s.id }}" method="post" action="/subscriptions/{{ s.id }}/update" style="margin:0; display:inline;">
                <button class="btn save-btn" type="submit">Save</button>
              </form>
              <button class="btn btn-ghost cancel-btn" type="button" data-edit="cancel">Cancel</button>
              <form method="post" action="/subscriptions/{{ s.id }}/delete" style="margin:0; display:inline;">
                <button class="btn btn-danger" type="submit">Delete</button>
              </form>
            </td>
        </tr>
        {% endfor %}

        {% if not subs %}
        <tr>
            <td colspan="5" class="empty">
            まだ登録がありません（まずは1件追加してみてね）
            </td>
        </tr>
        {% endif %}
        </tbody>
    </table>

    <div class="footer">
        <span>APIドキュメント:</span>
        <a class="link" href="/docs">/docs</a>
        <span>JSON:</span>
        <a class="link" href="/api/subscriptions">/api/subscriptions</a>
    </div>
    </div>
</div>