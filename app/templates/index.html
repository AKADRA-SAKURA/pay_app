<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>固定費（サブスク）</title>

  <style>
    :root {
      --bg: #f6f8f7;
      --card: #ffffff;
      --text: #1f2937;
      --muted: #6b7280;
      --border: rgba(17, 24, 39, 0.10);

      /* 家計簿アプリっぽい優しいアクセント */
      --accent: #2fb7a7;        /* mint/teal */
      --accent-weak: #e7f7f4;   /* very light */
      --danger: #ef4444;
      --danger-weak: #fee2e2;

      --radius: 18px;
      --shadow: 0 10px 30px rgba(17, 24, 39, 0.08);
      --shadow-soft: 0 6px 16px rgba(17, 24, 39, 0.06);
    }

    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background: radial-gradient(1200px 600px at 10% -10%, #e8f7f4 0%, transparent 60%),
                  radial-gradient(900px 500px at 90% 0%, #f3f8ff 0%, transparent 55%),
                  var(--bg);
      color: var(--text);
    }

    .wrap {
      max-width: 980px;
      margin: 0 auto;
      padding: 24px 18px 40px;
    }

    .header {
      display: flex;
      align-items: flex-end;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 18px;
    }

    h1 {
      margin: 0;
      font-size: 28px;
      letter-spacing: 0.2px;
    }

    .sub {
      margin: 6px 0 0;
      color: var(--muted);
      font-size: 13px;
    }

    .grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 14px;
    }

    @media (min-width: 860px) {
      .grid {
        grid-template-columns: 1fr 1.2fr;
        align-items: start;
      }
    }

    .card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow-soft);
      padding: 16px;
    }

    .card h2 {
      margin: 0 0 12px;
      font-size: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      padding: 6px 10px;
      border-radius: 999px;
      background: var(--accent-weak);
      color: #0f766e;
      font-size: 12px;
      border: 1px solid rgba(47, 183, 167, 0.25);
    }

    .form {
      display: grid;
      grid-template-columns: 1fr;
      gap: 10px;
    }

    @media (min-width: 520px) {
      .form {
        grid-template-columns: 1.2fr 0.9fr 0.9fr;
      }
    }

    label {
      display: grid;
      gap: 6px;
      font-size: 12px;
      color: var(--muted);
    }

    input {
      width: 100%;
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid var(--border);
      background: #fbfcfc;
      color: var(--text);
      outline: none;
      transition: border-color 120ms ease, box-shadow 120ms ease, transform 120ms ease;
    }

    input:focus {
      border-color: rgba(47, 183, 167, 0.55);
      box-shadow: 0 0 0 4px rgba(47, 183, 167, 0.16);
      background: #ffffff;
    }

    .actions {
      display: flex;
      align-items: center;
      justify-content: flex-end;
      gap: 10px;
      margin-top: 12px;
      flex-wrap: wrap;
    }

    .hint {
      color: var(--muted);
      font-size: 12px;
      margin-top: 10px;
      line-height: 1.4;
    }

    .btn {
      appearance: none;
      border: 1px solid rgba(47, 183, 167, 0.35);
      background: linear-gradient(180deg, #38c1b1 0%, #26a89a 100%);
      color: white;
      padding: 10px 14px;
      border-radius: 14px;
      cursor: pointer;
      font-weight: 600;
      letter-spacing: 0.2px;
      box-shadow: 0 10px 18px rgba(47, 183, 167, 0.25);
      transition: transform 120ms ease, filter 120ms ease;
    }

    .btn:hover { filter: brightness(1.03); transform: translateY(-1px); }
    .btn:active { transform: translateY(0px); }

    .btn-ghost {
      border: 1px solid var(--border);
      background: #fff;
      color: var(--text);
      box-shadow: none;
    }

    .btn-danger {
      border: 1px solid rgba(239, 68, 68, 0.35);
      background: linear-gradient(180deg, #ff6b6b 0%, #ef4444 100%);
      box-shadow: 0 10px 18px rgba(239, 68, 68, 0.18);
    }

    table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      overflow: hidden;
      border-radius: 14px;
      border: 1px solid var(--border);
    }

    thead th {
      text-align: left;
      font-size: 12px;
      color: var(--muted);
      background: #f9fbfb;
      padding: 10px 12px;
      border-bottom: 1px solid var(--border);
    }

    tbody td {
      padding: 12px;
      border-bottom: 1px solid rgba(17, 24, 39, 0.06);
      vertical-align: middle;
      background: white;
    }

    tbody tr:last-child td { border-bottom: none; }

    .money {
      font-variant-numeric: tabular-nums;
      font-weight: 650;
    }

    .pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 10px;
      border-radius: 999px;
      font-size: 12px;
      color: #0f766e;
      background: var(--accent-weak);
      border: 1px solid rgba(47, 183, 167, 0.25);
    }

    .empty {
      color: var(--muted);
      font-size: 13px;
      padding: 16px;
      text-align: center;
    }

    .footer {
      margin-top: 14px;
      color: var(--muted);
      font-size: 12px;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items: center;
    }

    .link {
      color: #0f766e;
      text-decoration: none;
      font-weight: 600;
    }
    .link:hover { text-decoration: underline; }

    /* スマホ：ボタン押しやすく */
    @media (max-width: 520px) {
      .actions { justify-content: stretch; }
      .btn { width: 100%; }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="header">
      <div>
        <h1>固定費（サブスク）</h1>
        <p class="sub">やさしい見た目で、まずは「登録→一覧」から。次は月間ビューに進めるよ。</p>
      </div>
      <span class="badge">LAN: http://{{ request.client.host }}:8000</span>
    </div>

    <div class="grid">
      <div class="card">
        <h2>追加 <span class="pill">毎月の固定費</span></h2>

        <form method="post" action="/subscriptions" class="form">
          <label>
            名称
            <input name="name" placeholder="Netflix" required />
          </label>

          <label>
            金額（円）
            <input name="amount_yen" type="number" min="0" value="0" required />
          </label>

          <label>
            毎月の請求日（1-31）
            <input name="billing_day" type="number" min="1" max="31" value="1" required />
          </label>

          <div class="actions" style="grid-column: 1 / -1;">
            <button class="btn" type="submit">追加する</button>
            <button class="btn btn-ghost" type="reset">クリア</button>
          </div>

          <div class="hint" style="grid-column: 1 / -1;">
            ※ まずは簡易版（1〜31固定）。月末（30/31/28）補正や「支払日カレンダー」は次で入れよう。
          </div>
        </form>
      </div>
<div class="card" style="margin-top: 14px;">
  <h2>予定（給料・定期支払） <span class="pill">M1-2</span></h2>

  <form method="post" action="/plans" class="form">
    <label>
      種別
      <input name="type" placeholder="income or subscription" value="income" required />
    </label>

    <label>
      タイトル
      <input name="title" placeholder="給料 / 家賃 / Netflix" required />
    </label>

    <label>
      金額（円）
      <input name="amount_yen" type="number" min="0" value="0" required />
    </label>

    <label>
      口座ID（account_id）
      <input name="account_id" type="number" min="1" value="1" required />
    </label>

    <label>
      頻度（monthly/yearly/monthly_interval）
      <input name="freq" value="monthly" required />
    </label>

    <label>
      日（1-31）
      <input name="day" type="number" min="1" max="31" value="1" />
    </label>

    <label>
      interval（月）
      <input name="interval_months" type="number" min="1" value="1" />
    </label>

    <label>
      month（年1回の月 1-12）
      <input name="month" type="number" min="1" max="12" value="1" />
    </label>

    <div class="actions" style="grid-column: 1 / -1;">
      <button class="btn" type="submit">予定を追加する</button>
    </div>

    <div class="hint" style="grid-column: 1 / -1;">
      ※ いったん入力は“素朴”でOK。次のステップでプルダウン化＆口座選択にします。
    </div>
  </form>
</div>

      <div class="card">
        <h2>一覧 <span class="pill">登録済み</span></h2>

        <table>
          <thead>
            <tr>
              <th style="width:70px;">ID</th>
              <th>名称</th>
              <th style="width:140px;">金額</th>
              <th style="width:150px;">請求日</th>
              <th style="width:100px;"></th>
            </tr>
          </thead>

          <tbody>
            {% for s in subs %}
            <tr>
              <td>{{ s.id }}</td>
              <td style="font-weight:650;">{{ s.name }}</td>
              <td class="money">{{ "{:,}".format(s.amount_yen) }} 円</td>
              <td><span class="pill">毎月 {{ s.billing_day }} 日</span></td>
              <td>
                <form method="post" action="/subscriptions/{{ s.id }}/delete" style="margin:0;">
                  <button class="btn btn-danger" type="submit">削除</button>
                </form>
              </td>
            </tr>
            {% endfor %}

            {% if subs|length == 0 %}
            <tr>
              <td colspan="5" class="empty">まだ登録がありません（まずは1件追加してみてね）</td>
            </tr>
            {% endif %}
          </tbody>
        </table>

        <div class="footer">
          <span>APIドキュメント:</span>
          <a class="link" href="/docs">/docs</a>
          <span>JSON:</span>
          <a class="link" href="/api/subscriptions">/api/subscriptions</a>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
